---
- name: "Generate {{ yamls }}/{{ name }}-{{ item }}.yml"
  template:
    src: "../templates/{{ template }}-{{ item }}.yml"
    dest: "{{ yamls }}/{{ name }}-{{ item }}.yml"
  with_items: "{{ files }}"
  when: files is defined

- name: "Generate Kubernetes {{ file }} files using prefix {{ prefix }}"
  set_fact:
    name: "{{ prefix }}-{{ item }}"
  template:
    src: "../templates/{{ template }}-{{ file }}.yml"
    dest: "{{ yamls }}/{{ prefix }}-{{ item }}-{{ file }}.yml"
  with_items: "{{ names }}" 
  when: names is defined and file is defined



